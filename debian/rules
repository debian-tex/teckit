#!/usr/bin/make -f

#DEB_AUTO_UPDATE_DEBIAN_CONTROL:=yes

DEB_TAR_SRCDIR := teckit-2.5.4

include /usr/share/cdbs/1/rules/tarball.mk

#include /usr/share/cdbs/1/rules/patchsys-quilt.mk

common-configure-arch common-configure-indep::
	@PERLVER=$$(dpkg-query -W -f '$${Version}' perl); \
	echo "Perl version is $$PERLVER"; \
	if dpkg --compare-versions $$PERLVER lt 5.20; then \
		echo "Using an old (non-multiarch) perl"; \
		cp debian/libteckit-perl.install.oldperl \
		   debian/libteckit-perl.install; \
	fi

include /usr/share/cdbs/1/rules/debhelper.mk
include /usr/share/cdbs/1/class/autotools.mk

DEB_DH_SHLIBDEPS_ARGS_teckit := -lteckit

build/libteckit-perl ::
	cd $(DEB_SRCDIR)/source/Perl ; perl Makefile.PL INSTALLDIRS=vendor
	cd $(DEB_SRCDIR)/source/Perl ; $(MAKE) OPTIMIZE="-O2 -g -Wall"

install/libteckit-perl ::
	cd $(DEB_SRCDIR)/source/Perl ; $(MAKE) install PREFIX=$(CURDIR)/debian/tmp/usr

